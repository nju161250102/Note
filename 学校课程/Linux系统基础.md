# Linux系统基础
参考教材《Linux实用教程》（第2版）

## 1 认识Linux系统
### 1.1 Linux系统简介
#### 1.1.1 什么是Linux系统
Linux是一个免费的、多用户、多任务的操作系统，其运行方式、功能和UNIX系统很相似，但Linux系统的稳定性、安全性与网络功能是许多商业操作系统所无法比拟的。Linux系统最大的特色是源代码完全公开，在符合GNU/GPL（通用公共许可证）的原则下，任何人都可以自由取得、传播甚至修改源代码。  

#### 1.1.2 Linux系统的产生
Linux系统内核最早由芬兰大学生Linus Torvalds开发，并于1991年8月发布。  

### 1.2 Linux系统的特点与组成 
#### 1.2.1 Linux系统的特点
* 开放性
* 多用户
* 多任务
* 良好的用户界面
* 设备独立性
* 丰富的网络功能
* 可靠的系统安全
* 良好的可移植性

#### 1.2.2 Linux系统的组成  
* 内核  
内核是操作系统的核心，具有很多最基本的功能，如虚拟内存、多任务、共享库、需求加载、可执行程序和TCP/IP网络功能。Linux内核的主要模块分为存储管理、CPU和进程管理、文件系统、设备管理和驱动、网络通信、系统的初始化和系统调用等几个部分。  
* Shell  
Shell是系统的用户界面，提供了用户与内核进行交互操作的一种接口。实际上，Shell是一个命令解释器，它解释由用户输入的命令并且将它们送到内核。  
* 文件系统  
文件系统是文件存放在磁盘等存储设备上的组织方法。  
* 应用程序  
标准的Linux系统都有一套称为应用程序的程序集。 

#### 1.2.3 Linux系统与Windows系统的比较
* 共性  
多用户操作系统、支持多种文件系统、支持多种端口和设备、支持联网功能、服务  
* 区别
应用目标、图形化界面、文件扩展名、重新引导、命令区分大小  

### 1.3 Linux版本介绍
#### 1.3.1 Linux内核版本
内核版本号由3个数字组成：r.x.y。  
* r：目前发布的内核主版本。  
* x：偶数表示稳定版本；奇数表示开发版本。  
* y：错误修补的次数  

#### 1.3.2 Linux发行版本
常见的Linux发行版本：Red Hat、Debian、Ubuntu

## 2 Fedora 17系统的安装和删除
#### 2.1.2 Linux系统下硬盘的基础知识
/dev/xxyN:  
* /dev/ Linux系统下所有设备文件所在的目录名
* xx 前两个字母代表了分区所在设备的类型，通常是hd(IDE硬盘)或sd(SCSI硬盘)
* y 这个字母表示分区所在的设备。a-z表示顺序。
* N 代表分区。1-4表示主分区或扩展分区，逻辑驱动器从5开始。  

合理的分区方案：  
* /boot 存放与Linux系统启动有关的程序，100MB以上
* /usr Linux系统中的用户程序，>9GB
* /var 经常变化的数据和日志文件，>1GB
* /home 存放普通用户的数据
* / 根目录 >2GB
* SWAP分区 实现虚拟内存，大小为物理内存的1-2倍  

### 2.3 删除Fedora系统
删除安装在MBR中的GRUB引导程序  
删除Linux分区  

## 4 Linux字符界面操作
### 4.1 字符界面简介
#### 4.1.1 进入Linux命令行界面
用户登录时依次输入用户名和密码，超级用户登录后提示符是#，其他用户登录后提示符是$。  
字符界面下使用Alt+功能键（图形界面用Ctrl+Alt+功能键）打开/切换不同的控制台。

#### 4.1.2 关闭和重启系统
**shutdown:** [选项] [时间] [警告信息]  
* -k 不关闭，只警告
* -r 关闭后立即重新启动
* -h 关闭后不重新启动
* -f 快速关闭，重新启动时不检测磁盘
* -n 快速关闭，不经过init程序
* -c 中断关闭系统  

**halt:**  
halt = shutdown -h  
**reboot:**  
关闭系统  
**init:**  
init 0关闭系统, init 6重启系统  
> 系统运行级别
> * 0 停止运行，关闭系统
> * 1 单用户模式
> * 2 多用户模式
> * 3 完整的多用户模式，进入字符界面
> * 4 自定义
> * 5 完整的多用户模式，进入图形界面
> * 6 重新引导计算机  

### 4.3 shell基础
#### 4.3.1 shell起步
[用户名@主机 工作目录]提示符：root用户的提示符以"#"结尾，普通用户为"$"  
shell命令的一般格式为\[Shell命令\]\[可选项\][参数]  
Linux系统由内核、shell、文件系统和应用程序三部分组成

### 4.4 Shell实用功能
#### 4.4.1 命令行自动补全
Tab：根据前面的输入快速补全命令和文件名称

#### 4.4.2 命令历史记录
上下方向键遍历命令，与shift连用遍历输出，~是主目录的缩写形式。

#### 4.4.3 命令的排列、替换和别名
* 命令1;命令2：不管命令1是否出错都执行命令2
* 命令1&&命令2：命令1正确执行后执行命令2
* 命令1 $(命令2)：命令2输出作为命令1的参数
* 命令别名：alias [别名] = 需要定义别名的命令

#### 4.4.4 文件名匹配和输出重定向
* 通配符\*，匹配一个或多个字符
* 通配符?，匹配一个字符
* 管道|，将输出信息作为命令的输入
* 输出重定向>
* 输入重定向<
* 错误重定向2>
* 追加重定向>>
* 同时实现错误和输出的重定向&>

### 4.5 vi编辑器的基本使用
#### 4.5.1 vi的基本概念
三种工作模式：命令行模式、插入模式、末行模式。

## 5 文件和目录
### 5.1 Linux文件
#### 5.1.1 Linux文件的扩展名
压缩和归档文件、一般文件、系统文件、编程和脚本文件
> file file_name 查看文件的类型

#### 5.1.2 Linux文件类型
ls -lh 查看某个文件的属性，第一个字符：
* -表示文件
* d表示文件夹
* b表示块设备文件（随机读写，例如磁盘）
* c表示字符设备（可以接收字符流，例如打印机和终端）
* p表示管道文件
* l表示符号链接文件

### 5.2 Linux目录结构
* home 各用户的主目录
* root root用户的主目录
* bin 常用的命令文件
* dev 大部分的设备文件
* lib 共享文件和内核模块文件
* mnt 默认挂载目录
* tmp 临时文件
* etc 大部分配置文件
* var 不常变化的数据

### 5.3 文件和目录操作
* pwd 显示工作目录路径
* cd 改变工作目录路径，绝对路径从/开始，..表示父目录，~为用户主目录
* ls 列出子目录和文件信息
  * -a 显示隐藏文件
  * -c 按修改时间排序
  * -F 添加文件类型标记
  * -l 以长格式显示文件的详细信息
* touch 创建空文件、更改文件或目录时间 -d/-t
* mkdir 创建目录 -m添加权限
* rmdir 删除目录 -p递归删除目录
* cp 复制文件和目录
* mv 移动或更名现有文件或目录
* rm 删除文件或目录 
  * -f 忽略不存在的文件，不提示
  * -r 递归删除
* wc 统计文件行数、单词数和字节数
  * -l 行数
  * -w 单词数
  * -c 字节数

### 5.4 链接文件

#### 5.4.1 链接文件简介

#### 5.4.2 链接文件使用

> ln -s创建符号链接而不是硬链接  源文件名 链接文件名

## 6 Linux常用操作命令

### 6.1 文本显示和处理

* cat 显示文本文件
* more 分页显示文本文件 空格键下一页，b返回上一页
* less 回卷显示文本文件
* head 显示指定文件前若干行
* tail 查看文件末尾数据
* sort 对文件中的数据进行排序
  * -r 倒序
  * -f 不区分大小写
  * -d 按字典顺序
* uniq 删除重复行
* cut 从每行中显示出选定的字节、字符或字段
* comm 比较两个已排序文件
* diff 逐行比较两个文件

### 6.2 文件和命令查找



## 7 Shell编程
### 7.1 熟悉Shell程序的创建
#### 7.1.1 语法基本介绍
以#!/bin/bash开头，使用chmod u+x 文件名来获取执行权限，使用#表示注释。  

### 7.2 Shell变量
#### 7.2.1 Shell定义的环境变量
* HOME：用于保存用户宿主目录的完全路径名。
* PATH：默认命令搜索路径。
* TERM：终端的类型。
* UID：当前用户的识别号。
* PWD：当前工作目录的绝对路径名。
* PS1：用户平时的提示符。
* PS2：第一行没输完，等待第二行输入的提示符

#### 7.2.2 用户定义的变量
变量名=变量值，定义变量时不加$，使用变量加$，建议所有变量用大写字母表示。readonly表示只读，export将局部变量导出。

#### 7.2.3 位置参数
第一个位置参数替换程序文件中的$1，第二个替换$2，依次类推。$0是一个特殊的变量，它的内容是当前这个Shell程序的文件名。

#### 7.2.4 预定义变量
* $#：位置参数的数量。
* $*：所有位置参数的内容。
* $?：命令执行后返回的状态。
* $$：当前进程的进程号。
* $!：后台运行的最后一个进程号。
* $0：当前执行的进程名。

#### 7.2.5 参数置换的变量
* ${variable:-value}: 如果variable存在，返回variable，否则返回value
* ${variable:=value}: 如果variable存在，返回variable，否则将值赋给变量然后返回值
* ${variable:+value}: 如果variable存在，返回value，否则返回空值。
* ${variable:?value}: 如果variable存在，返回variable，否则将value送到标准错误输出显示并退出shell程序，这里value通常为一个错误提示消息。
* ${variable:offset[:length]}:其中offset和length为整数数字，中括号代表可选部分。此引用方式表示返回从变量variable的第(offset+1)个字符开始的、长度为length的子串。如果中括号内的部分省略，则返回其后的所有子串。

### 7.3 变量表达式
test [表达式]

#### 7.3.1 字符串比较
=相等，!=不等，-n大于0？，-z等于0？

#### 7.3.2 数字比较
-eq：相等，-ge：大于等于，-le：小于等于，-ne：不等于，-gt：大于，-lt：小于

#### 7.3.3 逻辑测试
!：相反的逻辑，-a：与，-o：或

#### 7.3.4 文件操作
-d：存在且为目录，-f：存在且为文件，-L：存在且为符号链接，-r：存在且可读，-s：存在且长度非0，-w：存在且可写，-x：存在且可执行

### 7.4 Shell程序的执行和追踪
执行：bash 程序名；bash< 程序名；chmod  
调试：-v：显示shell输入行，-x：显示命令以及参数

### 7.5 流程控制 
#### 7.5.1 条件判断
```
if [test表达式]
then
	命令行1
else
	命令行2
fi
```
```
case string in 
exp-1)
	若干命令行1
exp-2)
	若干命令行2
……
esac
```
#### 7.5.2 循环控制
```
for 变量名 in [数值列表]
do
	若干命令行
done
```
```
while / until
	若干命令行1
do
	若干命令行2
done
```

## 8 用户和组群账户管理
### 8.1 用户账户管理
#### 8.1.1 Linux用户账户概述
* root用户
* 虚拟用户
* 普通用户

#### 8.1.2 Linux用户账户配置
* /etc/password 任何用户均可读:
用户名|口令|用户标识号（唯一）|组群标识号|用户名全称|主目录|登录Shell  
* /etc/shadow 仅root用户可读和操作:
用户名|加密口令|最后一次修改日期|允许更换前的天数|需要更换的天数|更换前警告的天数|被取消激活前的天数|过期日期|保留字段  

#### 8.1.4 字符界面下用户账户的设置
创建用户：useradd -d 主目录 -g 组群 -u uid
修改密码：passwd
修改用户：usermod -l 登录名 -c 全称
删除用户：userdel -r 用户名

### 8.2 组群账户管理
* /etc/group:
用户组群名|用户组群口令|GID（1000-60000）|组群成员
* /etc/gshadow:
组群名|组群口令|组群管理者|组群成员
* groupadd
* groupmod
* groupdel

### 8.3 账户相关文件或目录
* /etc/skel:
存放用户启动文件的目录
* /etc/login.defs
文件规定了创建新用户时的一些默认设置
* /etc/default/useradd
文件是在使用useradd命令创建用户账户时的规则文件

### 8.4 用户和组群维护命令
#### 8.4.1 账户维护命令
* passwd -S 锁定 -u 解锁
* gpasswd -a 增加 -d 删除 -r 取消
* chfn 更改用户信息
* chsh 更改用户账户的shell类型
* su 切换登录身份
* pwck 校验用户配置文件
* newgrp 以另一组群身份登录

#### 8.4.2 账户信息显示
* finger 显示用户账户信息
* groups 显示组群成员身份
* id 显示用户id以及所属组群id
* w 查询已登录用户
* who 显示已登录用户的简单信息

### 8.5 实现账户安全
chage 管理用户口令的时效

## 9 磁盘和文件系统管理
### 9.1 Linux硬盘分区
#### 9.1.1 硬盘分区知识
类型：主分区、扩展分区、逻辑分区  
分区工具：fdisk  
格式化产生文件系统：ext3、ext4

#### 9.1.2 使用fdisk进行硬盘分区
fdisk:  
* -b: 指定分区大小
* -l: 列出指定影片的分区表信息
* -s: 输出指定的分区大小

### 9.2 Linux文件系统简介
#### 9.2.1 Linux文件系统的工作原理
块分配&扩展分配

#### 9.2.2 Linux主流文件系统
ext3, ext4, JFS, ReiserFS, XFS

Linux常用发行版、Linux系统组成、内核介绍
Linux分区
窗口切换/终端切换
转换0-7，控制台切换、关闭重启系统、shell介绍、vi（几种模式、移动保存退出）
查找文件等3个
shell编程（语句、函数）
用户管理，组管理，常用命令，login default
磁盘分区（步骤：分区、创建文件系统、挂载）
基本权限设定、显示
rpm安装升级卸载选项，yrm，apache命令，ps/aux选项，pop命令。进程管理命令
定时程序分时日月周，用户...，执行一次的程序，系统的启动顺序