# 数据库开发技术

## Chapter0 前言
### 数据库基础知识
* 关系代数
* DB、DBMS基于数据库应用程序
* 数据库发基本特性
* SQL（基本DDL、DML、触发器、存储过程、语法、用法）

### 开发成功数据库应用的要点
* 理解数据库体系结构
* 理解锁和并发控制特性（每个数据库以不同的方式实现）
* 不要把数据库当作“黑盒”
* 性能、安全性都是适当的被设计出来的
* 用尽可能简单的方法解决问题
* DBA和RD之间的关系


## Chapter1 为性能而设计
应用系统的首要目标：满足业务需求  
实际的情况是：  
* 处于技术挑战的刺激之下
* 忽视目标
* 重视手段
* 忽视数据的质量
* 重视按期交付功能
强调良好的模型和合理的数据库设计是任何信息系统的基础  

### 数据的关系视图
* 关系模型中关系的含义
* 关系模型的一致性：  
只要遵守关系理论，可以保证基于数据库的任何查询结果与原始数据具有同样的有效性。关系理论包括：关系不包含重复数据；记录之间没有顺序。查询效率与更新效率不能同时提高。（要有选择地进行优化）

### 规范化
* 1NF确保原子性（原子性的力度和价值）
* 2NF检查对键的完全依赖（控制数据冗余和查询性能）
* 3NF检查属性的独立性  

规范化的价值：
* 合理规范化的模型可应对需求变更
* 规范化数据重复降至最少

### 有值，无值、空值
* 表中每一条记录都应该是事物的状态描述，如果大部分信息都显示“不知道”，无疑大大降低了信息可信性。
* 存在空值意味着关系模型存在严重的问题。
* 空值对程序逻辑是危险的，必须使用的话一定要清楚在特定情况下的影响。

### 限用Boolean字段
SQL中不存在Boolean类型。通过实现flag表示标志位的Y/N或T/F，但是往往会增加信息字段包含更多的信息。更不要通过数字来表示所有的状态组合。  
```
数据库一开始要尽量直观，不要引入巧妙的设计。数据存储领域中，往往是用空间换时间，不需要巧妙地减少空间占用.
```

### 理解子类型（SubType）
* 表中有太多属性的另一个原因，是对数据项之间的关系了解不够深入。
* 一般情况下，给子类型表指定完全独立于父表主键的主键是极其错误的。
```
完备型的分类方式可以通过遍历查询来完成。不完备的分类方式下，通过一张对应表存放父表记录对应的类型表名。
```

### 约束应明确说明
* 数据库中隐含约束是一种不良设计（约束应当明确）
* 字段的性质随着环境变化而变化时设计的错误和不稳定性
* 数据语义属于DBMS，不能放到应用程序中（数据库中找脏数据是极其困难的）

### 如何处理历史数据
定义有效时间、定义终止时间、保持价格生效时间……  

### 设计与性能
调优（tuning）在目前情况下性能优化至最佳  
性能拙劣的罪魁祸首是错误的设计  

### 处理流程
* 异步模式处理（批处理）
* 同步模式处理（实时交易）  
处理数据的方式会影响我们物理结构的设计  

### 数据集中化（Centralizing）
分布式数据系统的复杂性大大增加：远程数据的透明引用访问代价很高，不同数据源数据结合极为困难。离数据越近，访问速度越快。 
```
选择分布式系统的原因：分布式数据库的吞吐量大。单条查询速度慢，但是大量查询的速度更快，更有利于大规模访问。
```

## Chapter2 高效访问数据库
开发环境比生产环境简单得多。开发者常常忽略从大局上把握整个架构和设计。
```
硬盘读写以块为单位
```

## 期末复习
### 1 DBMS相关问题
#### DBMS的执行过程
* 语法分析：分析语句语法是否符合规范、衡量表达式意义
* 语义分析：检查语句中的数据库对象是否存在并且用户具有相应的权限
* 视图转换：涉及视图的查询转换为对基表的查询
* 表达式转换：复杂的SQL表达式转为较简单的等效连接
* 选择优化器
* 选择连接方式表
* 选择连接顺序
* 选择对数据的搜索路径
* 运行执行计划

#### 语义分析的硬解析和软解析
硬解析：在共享池中没有找到已有的执行计划，则使用优化器对sql语句进行优化，转化为一些等价语句，并选择代价最小的语句生成执行计划。

软解析：共享池中已经存在对应的执行计划，直接使用。

#### MySQL三层逻辑架构
* 连接管理、授权认证、安全：每个连接对应一个线程，通过用户名/密码或者SSL证书进行认证和权限检查
* 解析查询、优化：调整顺序、选择合适的索引、检查缓存
* 存储引擎：存取数据、开启事务

### 2 索引相关问题