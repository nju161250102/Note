# 软件需求工程
参考教材：需求工程——软件建模与分析（第2版）  

## 1 软件需求导论

### 1.1 软件生产中的需求问题
需求问题是当前软件开发面临的主要问题。  
软件的三种类别：  

* 面向专业用户的应用软件
* 面向普通用户的应用软件
* 应用软件  

需求问题的具体技术原因分析：    
* 理解需求处理中的非技术性和社会性因素：组织机构文化、社会背景、商业目标、利益协商
* 结构化分析和面向对象分析具有一定的先天缺陷
* 以企业为中心的软件反映出软件规模的扩大
* 纠正需求的错误需要极高的代价  

### 1.2 需求工程
#### 1.2.1 需求工程简介
**需求工程定义：**是软件工程的一个分支，它关注于软件系统所应予实现的现实世界目标、软件系统的功能和软件系统应当遵守的约束，同时它也关注以上因素和准确的软件行为规格说明之间的联系，关注以上因素与其随时间或跨产品族而演化之后的相关因素之间的联系。  
需求工程的基本活动：  
* 需求开发
  * 需求获取
  * 需求分析
  * 需求规格说明
  * 需求验证
* 需求管理  

#### 1.2.2 需求工程与系统工程
系统需求开发-早期阶段；软件需求开发-后期阶段。  

#### 1.2.3 需求工程的重要性
特定问题的具体特性掩盖了需求工程的重要性：问题广为人知；问题小而简单。

#### 1.2.4 需求工程的复杂性
处理范围广泛；涉及诸多参与方；处理内容多样；处理活动互相交织；处理结果要求苛刻。  

## 1.3 需求工程师
需求工程师是涉众与开发者之间的桥梁。  
需求工程师需要重视软技能（交流、观察、抽象分析和问题解决、写作、关系协调与团队工作）  


## 2 需求基础
### 2.1 需求的定义
1. 用户为了解决问题或达到某些目标所需要的条件或能力；
2. 系统或系统部件为了满足合同、标准、规范或其它正式文档所规定的要求而需要具备的条件或能力；
3. 对（1）或（2）中的一个条件或一种能力的一种文档化表述。  

### 2.2 满足需求就是解决问题
#### 2.2.1 问题与需求
现实的状况与人们期望的状况产生差距时，就产生了问题。  
开发软件系统的目的就是希望用它作为解决方案来解决问题，使现实改善到期望的状况。  

#### 2.2.2 问题解决的两个方面——问题域与解系统
**问题域：** 问题的发生地，也是问题解决的基本范围——解决问题必须涉及的事件和事物。问题域是需求的背景，问题域的背景信息（问题域自治的规律性）又称为问题域特性（包括结构特性和行为特性）。需要额外关注间接特性、约束与假设。  
**解系统：** 软件系统通过影响问题域帮助人们解决问题，称之为解系统。  
问题域与需求：**需求**是用户对问题域中的实体状态或事件的期望描述。需求开发最原始的出发点就是用户需求，或者需求的源头——问题。  
解系统与需求规格说明：**需求规格说明**是解系统为满足用户需求而提供的解决方案，规定了解系统的行为特征。  

#### 2.2.3 问题解决的基础——模拟与共享现象
问题域与解系统能够形成互动的基础是解系统部分模拟了问题域，称之为共享现象。  

#### 2.2.5 问题解决方案——需求规格说明
主要包括：对共享现象（模型）的描述和对系统对共享对象所施加的操作的描述。  

#### 2.2.6 问题解决的困难性
1. 不存在描述明确的E；
2. 不存在确定的针对S的评估标准R；
3. E=>S是一个创造性的过程。  

需求工程的主要工作：  
* 需求开发,确定R 
* 研究问题背景，描述问题域特性E 
* 构建解系统，描述解系统行为S，使得E,S|->R  

### 2.3 需求和问题都具有层次性
需求最常见的抽象层次：  
* 业务需求：针对整个业务的期望
* 用户需求：针对具体任务的期望
* 系统级需求：针对系统和用户一次交互的期望。  

#### 2.3.1 战略问题与业务需求
业务需求是抽象层次最高的需求，是系统建立的战略出发点，表现为高层次的目标，描述了组织为什么要开发系统。  
为了满足用户的业务需求，需求工程师需要描述系统高层次的解决方案（逐一细化），定义系统应该具备的特性。  

#### 2.3.2 任务问题与用户需求
用户需求就是执行实际工作的用户对系统所能完成的具体任务的期望，描述了系统能够帮助用户做些什么。  
**用户：** 直接用户和间接用户（通用、公共服务软件等用户无法确定的系统）  
基本表达方式：XX用户可以使用系统完成XX任务。  
用户需求的特点：  
* 模糊、不清晰：允许使用形容词和副词  
* 多特性混杂：允许混合功能和非功能性需求  
* 多逻辑混杂：一条用户需求所代表的任务需多次系统交互才能完成  

#### 2.3.3 系统行为问题与系统级需求
适合软件开发者的需求层次是系统级需求。用户对系统行为的期望，一系列的系统行为联系在一起可以帮助用户完成任务，满足业务需求。  
基本表达方式：系统可以XXX；在XXX用户提出XXX请求时，系统应该XXX。
系统级需求比用户需求更加详细和准确，包含更多的技术细节。在开发中经常与用户需求相混淆，需要开发者以各自的方式进行假设。系统级需求的建立需要需求分析人员的创造性（建立需求分析模型）  

#### 2.3.4 需求开发要遵循层次性
业务需求-[业务需求指导需求获取]-用户需求-[转化用户需求为系统级需求]-系统级需求  

### 2.4 需求的分类与表述
#### 2.4.1 需求的分类
广泛意义上的需求谱系：  
* 需求
	* 项目需求
	* 过程需求
	* 系统级需求（软件需求、硬件需求、其他需求）
* 不切实际的期望   

严格意义上的需求分类：  
* 功能需求：和系统主要工作相关的需求，表现为系统和环境之间的交互
* 性能需求：系统整体或组成部分拥有的性能特征
* 质量需求：系统完成工作的质量（可靠性程度、可维护性程度）
* 对外接口：与环境中其他系统之间需要建立的接口（硬件接口、软件接口、数据库接口）
* 约束：进行系统构造时需要遵守的约束（编程语言、硬件设施）
* 其他：数据需求等

#### 2.4.2 功能需求
功能需求是最常见、最重要、最为复杂的功能。  
功能需求是一个软件产品得以存在的原因，是软件开发工作的基础。  
功能需求最需要按照需求的三个层次展开。    

#### 2.4.3 性能需求
常见的性能需求：  
* 速度Speed：系统的响应时间。
* 容量Capacity：系统所能存储的数据量。
* 吞吐量Throughput：系统在连续的时间内完成的事务数量。
* 负载Load：系统可以承载的并发工作量。
* 实时性Time-Critical：严格的实时要求。  

#### 2.4.4 质量需求
概念：为了满足规定的及隐含的所有要求而需要具备的要素（包含性能需求）称为质量 。质量属性是为了度量质量要素而选用的特征。  
质量模型：更好的根据质量属性描述和评价系统的整体质量，选择一些相互配合、相互联系的特征集，称为质量模型。  
重要性：对设计影响很大；对越复杂的系统越为重要  
常见的质量属性需求：  
* 可靠性(reliability)
在规定时间间隔内和条件下，系统或部件执行所要求能力的能力
* 可用性(availability)
投入使用时可操作和可访问的程度或能实现其指定系统功能的概率
* 安全性(security)
阻止对其程序和数据进行未授权访问的能力
* 可维护性(maintainability)
能修改以排除故障、改进性能或其他属性或适应环境变化的容易程度
* 可移植性(portability)
从一种硬件或软件环境转换至另一种环境的特性。
* 易用性(usability)
用户使用软件所花费的努力以及对其使用的评价相关的特性。

#### 2.4.5 对外接口
对系统之间的软硬件接口需要说明以下内容：  
* 接口的用途
* 接口的输入输出
* 数据格式
* 命令格式
* 异常处理要求  
用户界面在有些情况下也会被视为系统的对外接口，被作为一种重要的需求。也可以使用专门的人机交互设计文档记录用户界面需求。

#### 2.4.6 约束
约束是在总体上限制了开发人员设计和构建系统时的选择范围。  
常见的约束：  
* 系统开发和运行的环境
* 问题域的相关标准（法律法规、行业标准、企业规章）
* 商业规则
* 社会性因素（文化、信仰）  

#### 2.4.7 其他需求
安装需求、培训需求、数据需求……

### 2.5 优秀需求的特性
**完备性**  
优秀的需求是完备的，不需要做更多的扩展就可以充分的说明用户所需要的系统功能。完备性的判断标准是：需求是否描述了开发人员设计和实现这项功能需要的所有信息。  
对功能需求确保：  
* 行为的触发者
* 行为的前置条件
* 行为
* 后置条件
* 不满足前置条件的情况  

对数据需求注意：  
  类型、语义、组成成分、初始值/默认值、取值范围、度量单位、数据量、更新频率、可以施加的合理操作、对外关系……  

对对外接口的描述注意：
* 接口的名字
* 接口的定义，简短的描述
* 接口的方向声明
* 服务请求  

对质量属性（含性能）的描述注意：  
* 针对系统或其部件的质量标准
* 明确了需要满足质量标准的情况与条件
* 衡量质量标准所使用的单位
* 质量度量的阈值

**正确性**  
每一项需求都必须正确描述所需要的系统功能，真实反映用户的意图，传递给开发人员之前必须由需求的提出者予以确认。  
发现真实需求的方法：  
* 多问用户“为什么”，将需求描述从具体情景、技术环境等约束中抽离出来
* 从业务方面描述需求，而不是从技术方面描述需求。
* 关注涉众的想法；关注涉众对需求的优先级划分；真正理解需求对于涉众的意义。
* 在演化中理解需求。将最初始的需求展示给涉众，并利用涉众的反馈发现真正的需求。
* 通过量化手段准确理解需求。对验证标准反复推敲。  

**可行性**  
需求必须能够在系统及其运行环境的已知条件和约束下实现，需求的可行性由开发人员检查，进行一定的分析和研究，必要时通过开发原型来验证。不可行的需求称为不切实际的期望。  

**必要性**  
每一项需求都应该是必要的，是满足用户的业务需求所必需的。  

**无歧义**  
每一项需求都应该有且只有一种解释，即需求无歧义。定义一个可以共同理解的词汇表。  

**可验证**  
通过分析、检查、模拟或者测试等方法能够判断需求是否被满足。不可验证的需求往往是因为描述模糊或者过于抽象，所以在进行需求的描述时要让需求具体化、小心形容词和副词的使用、避免程度词的使用。

## 3 需求工程过程
### 3.1 概述
过程是一组相关活动的集成，通过这些活动的执行，可以完成一项任务或者达到一个目标。需求工程过程是系统开发当中需求开发活动的集成。它的目标是产生一个能够在用户环境下解决用户业务问题的系统方案，并将其文档化为明确的规格说明。  
获取、分析、规格说明和验证并不是以线性顺序的执行，而是互相交织、迭代和递增的。  

### 3.2 需求工程活动
#### 3.2.1 需求获取
**需求获取**是从人、资料或者环境当中获取需求的过程。需求获取和需求分析是交织在一起的。  
需求工程师需要执行的任务包括：  
* **收集背景资料**：深入了解以形成基础的知识框架。
* **获取问题与目标**，定义项目的前景与范围：前景应对冲突、范围排除不必要的请求，坚定客户投资信心
* **识别涉众，选择信息的来源**：来源：用户、硬数据、产品/专家/文档
* **选择获取方法，执行获取，获取功能与非功能需求**：面谈、调查表、观察、原型等
* **记录获取结果**：项目前景与范围文档、笔录记录  

#### 3.2.2 需求分析
需求分析的主要工作是通过建模来整合各种信息，以使得人们更好的理解问题。同时为问题定义出一个需求集合，这个集合能够为问题界定一个有效的解决方案。还需要检查需求当中存在的错误、遗漏、不一致等各种缺陷，并加以修正。  
需求工程师的主要任务：  
* 背景分析：研究系统将要部署的环境
* 问题分析、目标分析、业务分析、确定系统边界
* 需求建模
* 细化需求：用户需求转化为系统级需求
* 确定优先级
* 需求协商

#### 3.2.3 需求规格说明
编写文档的主要目的是为了在系统涉众之间交流需求信息：  
* 业务需求——项目前景和范围文档
* 用户需求——用户需求文档（或者用例文档）
* 系统需求——需求规格说明 

主要工作：定制文档模板——编写文档  

#### 3.2.4 需求验证
确保文档满足标准：  
* 文档内每条需求都正确、准确的反映了用户的意图
* 文档记录的需求集在整体上具有完整性和一致性
* 文档的组织方式和需求的书写方式具有可读性和可修改性

主要工作：执行验证（同级评审、原型、模拟）——问题修正（跟踪以确保落实）

#### 3.2.5 需求管理
需求管理保证需求作用的持续、稳定和有效发挥。  
主要工作：  
* 建立和维护需求基线集 ：版本控制
* 建立需求跟踪信息（后向：制品，前向：高层需求） 
* 进行变更控制：策略、团队

### 3.3 需求开发的过程是迭代和并发的
RT.

### 3.4 实践方法的应用
#### 3.4.1 细节知识的实践性
个人才智——实践方法——知识体系

#### 3.4.2 重要的实践方法
课本表3-1和3-2

### 3.5 需求开发过程实例
* 螺旋模型：风险驱动项目的需求开发
* 原型模型：借鉴原型和分析模型的验证作用
* HP两阶段的需求开发过程模型
* 基于需求实践方法建立的需求开发模型
* 敏捷软件开发方法使用的需求开发模型
* RUP过程框架的需求开发模型

### 3.6 需求开发过程与软件工程过程的相互影响
需求工程过程是软件工程过程的一部分。

## 4 需求获取概述
### 4.2 需求获取中的常见困难
#### 4.2.1 用户和开发人员的背景不同，立场不同
* 知识理解的困难：研究背景、理解组织状况、形成粗略的知识框架
* 默认知识现象：有效的获取方法和技巧（角色扮演、观察）
> 默认知识：表达者看来不值得专门进行解释或提及的知识

#### 4.2.2 普通用户缺乏概括性、综合性的表述能力
* 普通用户——善于表达具体业务的细节问题
* 专家用户——回答概括性和综合性的问题 

#### 4.2.3 用户存在认知困境
潜在知识：人们认识不到自己已经知道的知识。

#### 4.2.4 用户越俎代庖
* 用户提出的不是需求，而是解决方案：注意保持业务领域和解决方案的区分界限
* 用户固执的坚持某些特征和功能：分析深层目的，找到隐藏的需求

#### 4.2.5 缺乏用户参与
* 用户数量太多，选择困难 
* 用户认识不足，不愿参与 
* 用户情绪抵制，消极参与 
* 没有明确的用户

### 4.3 需求获取活动
* 研究应用背景，建立初始的知识框架
* 根据获取的需要，采用必要的获取方法和技巧
* 先行确定获取的内容和主题，设定场景
* 分析用户的高（深）层目标，理解用户的意图
* 进行涉众分析，针对涉众的特点开展工作

### 4.4 获取信息的内容
* 需求：获取的主要对象，体现为用户的观点、看法、目标或者问题
* 问题域描述：现实世界的业务运行状况
* 环境与约束：来源于涉众描述和对应用环境的观察

### 4.5 获取信息的来源
* 涉众
* 硬数据
* 相关产品
* 重要文档
* 相关技术标准和法规

### 4.6 获取信息的方法
* 传统方法
* 集体获取方法
* 原型
* 模型驱动方法
* 认知方法
* 基于上下文的方法

### 4.7 获取信息的过程
#### 4.7.1 注意事项
* 在整体上制定组织方案 
* 维护项目的前景和范围
* 接受需求的不稳定性 
* 控制探索性工作

#### 4.7.2 防止遗漏需求
* 让所有的涉众都表达出自己的意见。
* 不要以抽象和模糊的需求作为结束。进行细化让真正的需求显露出来。
* 使用多种方法表达需求信息。利用不同的分析技术为相同的需求进行建模，通过分析不同的关注点，考察需求是否完整。
* 注意检查边界值和布尔逻辑。

#### 4.7.3 结束获取
* 用户想不出更多的用例
* 用户想出的新用例都是导出用例（通过其他用例的结合可以推导出该用例）
* 用户只是在重复已经讨论过的问题
* 新提出的特性、需求等都在项目范围之外
* 新提出的需求优先级都很低
* 用户提出的新功能都属于后继版本，而非当前版本 

### 4.8 获取信息的成果
* 笔录——普通的文本描述，没有经过分析和整理
* 录音和摄像——取得同意，代价昂贵
* 正式文档——项目前景和范围文档、用例文档

### 4.9 实践中的需求获取
主要关注以下几个问题：项目目标、项目范围、用户参与、交流问题、获取方法的使用。
#### 4.9.2 项目范围
常见错误：  
* 项目的边界定义不清晰，或者根本就没有定义项目的边界
* 定义的项目边界错误，使得最终的需求不完备或者冗余
* 没有控制已建立的项目边界，使得项目范围失控

#### 4.9.3 用户参与
* 没有能够有效的选择参与项目的用户
* 认识不足
* 用户抵制
* 没有明确的用户
* 管理上的障碍

#### 4.9.4 交流问题
最大的问题就是理解偏差。面对面的交流方式是最有效，也是最受欢迎的。直接交流途径优于间接交流途径。  

#### 4.9.5 获取方法的使用
方法选择的依据：  
* 需求的目的（细化的SRS或整体需求方案） 
* 知识的类型（静态/动态，抽象/详细）
* 知识内化的特性要求（新知识、潜在、场景、惯性、明显） 
* 可观察的现象 
* 约束（是否需要开会、准备/采集/获得需求的时间限制、工程师/涉众的数量、涉众支持程度、前导技术要求）

## 5 确定项目的前景与范围
### 5.1 引言
定义项目前景、定义项目范围。  
确定项目前景和范围的活动是定义业务需求和能够满足需求的高层解决方案。如果存在不同业务需求之间的冲突，那么在确定项目前景和范围阶段必须予以解决。  
确定项目的问题、目标、特性：  

* 问题：组织的战略目标、利益分配、政策规划、业务流程等高层问题
* 目标：问题的反面，用户的期望
* 特性：选定的、针对目标的解决方案所需要具备的功能特征  
分析手段由浅到深依次为问题分析、目标分析、业务过程分析：  
* 问题与目标明确->问题分析->用例图/上下文图
* 目标之间存在较为复杂的关系->目标分析->目标模型与目标实现
* 目标、特性之间存在紧密的联系->业务过程分析->UML活动图  

### 5.2 问题分析
#### 5.2.1 获取问题
* 收集背景资料：收集业务描述、统计数据，关注业务困难与问题
* 与涉众沟通（面谈）  

#### 5.2.2 明确问题
1. 对问题达成共识：用标准化的格式描述问题，在涉众之间取得认同。
2. 收集背景资料，判断问题的明确性：易于理解、能指明解决的方向。
3. 分析不明确的问题，发现问题背后的问题：直接咨询涉众、利用收集的资料和业务数据、必要的问题分析技巧。  
> 鱼骨图：显示某个总体效果的可能因子   

#### 5.2.3 发现业务需求
每一个明确、一致的问题都意味着涉众存在一些相应的期望目标，即业务需求。一般情况下，业务需求就是问题的反面。  

#### 5.2.4 定义问题解决方案及系统特性
* 建立问题解决方案  
发现各种可行的高层次解决方案，分析不同方案的业务优势和代价，然后通过和涉众的协商进行选定。提供候选方案，最终由用户决定。  
* 确定系统特性和解决方案的边界  
  * 明确方案具备的功能特征（即系统特性）
  * 面向对象方法：用例图（角色：用户；用例：目标-任务）
  * 结构化方法：问题的上下文图  
* 确定对解决方案的约束  

### 5.3 目标分析
处理问题、目标、特性、角色和任务之间的相互依赖关系。  
#### 5.3.1 “目标”概念——面向目标的软件需求工程方法
目标将会补充传统方法中的实体概念和行为概念，成为需求工程建模与分析的基本对象类别。  

#### 5.3.2 目标模型
**目标是系统被开发的目的**  
目标模型的描述需要精确描述和定义，常见基本特征：类型、名称、说明、优先级、可行性……  
* 目标的描述：类型、属性、链接
* 目标的层次：高层次目标/低层次目标
* 目标的主体：抽象、粗粒度、范围广的目标拥有更多的主体，区分目标的主体与涉众  
* 目标的分类：功能目标/非功能目标，软目标/硬目标  

元素之间的关系——链接
* 精化：有助于目标完成-AND精化，直接保证目标完成-完备AND精化，替代方案-OR精化  
* 目标阻碍：子目标的达成会使得高层目标失败  
* 目标之间的支持和冲突
* 目标和其他需求模型元素建立链接:  
Assignment-目标和主体，Operationalization-目标和操作，Covers-目标和场景，Concerns-目标与应用领域对象  

#### 5.3.3 目标分析过程
* 高层目标的获取
* 目标精化  
  * 获取对高层目标的描述
  * 从高层目标描述获取AND精化关系
  * 从高层目标描述中获取“候选方法”，发现OR精化关系
  * 考虑阻碍目标实现的情况
  * 发现目标冲突关系
  * 完善层次结构
* 目标实现

### 5.4 非功能需求分析
#### 5.4.1 为什么需要非功能需求分析
面向产品/面向过程  

#### 5.4.2 非功能需求分析的困难
* 非功能需求不集中，在系统中散布
* 非功能需求不独立，依赖于功能需求
* 非功能需求的质量需求比较复杂
* 非功能需求相互冲突、依赖

#### 5.4.3 使用面向目标的方法分析非功能需求

### 5.5 业务过程分析
#### 5.5.1 活动图
* 节点：动作节点、控制节点、对象节点
* 流：控制流、对象流
* 令牌平衡：验证活动图流转是否正确
* 信号与事件机制：发送动作信号、接收事件动作
* 异常与中断机制：异常处理、可中断活动区
* 分区：活动组、活动分区、泳道
* 层次结构与图简化元素  

#### 5.5.2 使用活动图进行业务过程分析
* 确定活动图的上下文环境 
* 界定业务流程的处理界限 
* 分析业务流程中的主要处理步骤 
* 分析业务流程中的主要数据流 
* 识别参与者，进行职责分配，划分不同的泳道，将处理步骤和数据流的传递组织起来，建立活动图 
* 添加活动图的详细信息，完善活动图描述  

### 5.6 定义系统边界
* 问题分析与系统边界定义  
每个问题的解决方案边界的合并
* 目标分析与系统边界定义
  * 边界目标：存在系统与环境的互动。
  * 边界目标所覆盖的场景和操纵的操作
  * 关注的数据对象：建立系统边界定义。
* 业务过程分析与系统边界定义  
依据其动作和对象流完善边界定义  

### 5.7 前景和范围文档

## 6 涉众分析与硬数据采样
### 6.1 什么是涉众
所有对软件系统的开发和应用具有发言权和决定权的人称之为**涉众**。

### 6.2 涉众分析
#### 6.2.1 如何进行涉众分析
按照复杂程度将信息系统分类：  
* 小型系统
* 组织级系统
* 战略信息系统
* 组织间系统  

#### 6.2.2 涉众分析过程
* 涉众识别
* 涉众描述
* 涉众评估
* 涉众代表选择
* 制定涉众代表参与需求开发乃至软件系统的参与系统  

目标、范围、涉众的交织过程  

### 6.3 涉众识别
#### 6.3.1 发现所有的关键涉众类别
* 发现所有涉众类别：  
最简单的区分特征是任务，不同类别的涉众会执行不同的任务。复杂情况下可以分析涉众之间的互动，发现深层次的信息。  
* 过滤非关键涉众类别：  
分析一个涉众类别的任务或他们与外界的交互活动，如果属于项目范围，服务于系统目标的满足，就属于关键类型。
* 维护涉众类别：  
完成分类后继续保持适当的关注  

#### 6.3.2 识别涉众的方法
* 先膨胀后收缩方法
* 检查列表方法
* 涉众网络方法

### 6.4 涉众描述
#### 6.4.1 描述哪些内容
涉众因素：  
* 涉众的输赢条件
* 涉众的力量与意愿
* 涉众的个人特征与公众特征  

#### 6.4.2 描述示例
略

### 6.5 涉众评估
#### 6.5.1 优先级评估
优先考虑涉众的基本特征，尤其是任务特征。  
User/Task矩阵。  
Power/Interest分布图：参与者、环境设定者、被影响者、观众。  

#### 6.5.2 风险评估
Power/Attitude分布图：弱支持者、强支持者、弱反对者、强反对者。  
化解风险：  
* 提高环境参与者对系统的关注，将他们转变为参与者
* 消除强反对者的反对原因，将他们变为强支持者
* 给予被影响者充分发表和实现自身意见的权力
* 化解弱反对者的忧虑。  

#### 6.5.3 共赢分析
发现冲突：建立Stakeholder/Issue关系图  
* 列出所有涉众类别，描述兴趣和对系统的期望
* 由涉众的兴趣和期望发现背后涉及的共同问题
* 建立涉众类别与问题的关联
* 对每一个Stakeholder/Issue关系标明关系上被寄予的期望  

### 6.6 涉众代表选择
#### 6.6.1 涉众采样
完整采样、态度积极、数量适中、比例恰当

#### 6.6.2 用户替代源
和涉众接触频繁的人

### 6.7 涉众参与策略制定
#### 6.7.1 制定涉众参与的基本策略
建立涉众参与矩阵

#### 6.7.2 敏捷方法——用户参与
* 建立和用户的直接联系
* 用户参与软件系统开发的整个过程
* 反馈设计：最终的软件系统和用户的活动行为密切相关  

### 6.9 硬数据及硬数据采样
#### 6.9.1 硬数据
定量硬数据：数据收集表格、统计报表  
定性硬数据：整个组织的描述化文档、业务指导文档、业务备忘  

#### 6.9.2 硬数据采样
样本大小SS = 0.25*（确定性因子/可接受的错误）^2  

## 7 基于用例/场景模型展开用户需求获取
### 7.1 用户需求活动的展开
#### 7.1.1 展开用户需求获取活动时的注意事项
* 要保持项目范围，不能有需求遗漏：参照系统特性，围绕系统边界设计获取活动计划
* 多轮次获取
* 根据内容合理安排获取方法
* 及时组织已获取需求，为后续获取提供指导

#### 7.1.2 用户需求获取活动的主线索
* 目标模型：业务需求
* 用例/场景模型：用户需求
* 面向对象分析模型、结构化模型：系统级需求

### 7.2 用例/场景
#### 7.2.1 什么是用例/场景
对系统和环境行为的局部描述。具有重点描述真实世界的特征，它利用情景、行为者之间的交互、事件随时间的演化等方式来叙述性的描述系统的使用。  
UML将用例定义为“在系统（或者子系统或者类）和外部对象的交互当中所执行的行为序列的描述，包括各种不同的序列和错误的序列，它们能够联合提供一种有价值的服务”  

#### 7.2.2 用例/场景的组织特点
以用例/场景为单位组织用户需求（和问题域特性），让用户、客户等应用领域内的涉众看起来更容易理解和接受。  

#### 7.2.3 用例/场景的层次性
可以组织三个层次的需求

### 7.3 用例/场景模型
#### 7.3.1 场景模型
场景的形式：场景的表达模式  
* 描述（Description） 
表示法的正规性 ；非形式化语言、半形式化语言和形式化语言；叙述性的自由文本、结构化文本、强限制文本、表格、图表、图像等。
* 外观（Presentation）
动态、静态、交互  

场景的内容：
* 主要关注点：关于现在的 ，关于未来的 ，关于解决方案的 
* 环境范围：系统内部，系统外部，系统和环境的交互
* 抽象层次：具体的、抽象的、混合的
* 覆盖范围：功能需求，非功能需求 
* 粒度：整个业务过程；某个任务的完成过程；某个交互行为的详细处理步骤 
* 示例类型：正常流程 ，异常流程 

场景的目的
* 描述（descriptive）需求的文档化，需求协商
* 探索（exploratory）需求获取 需求建模与分析 
* 解释（explanatory） 需求的验证 

生命周期

#### 7.3.2 用例的定位
* 用例是静态的结构化文本描述。
* 用例的内容可以是对当前世界的描述，也可以是对将来确定的解系统的内部行为描述，还可以是对一种期待的解决方案的描述。
* 用例可能会被用于描述系统内部的交互，也可能被用于描述系统和环境的交互，还可能会被用于描述行为的环境和背景。
* 用例是类型层次的事件描述，主要用来描述功能需求。可以包含其他类型的需求
* 用例的内容既包含有正常流程，又包含有异常流程。
* 用例可以是比较抽象的，用于描述整个业务过程；也可以是比较具体的，用于描述某个任务的完成过程；还可以是非常具体的，描述某个交互行为的详细处理步骤。
* 用例可以用于各种目的的应用，包括描述、探索和解释（explanatory）。需求获取和需求验证是它在需求工程中的主要应用阶段，它也可以用于需求的建模、交流和协商。
* 场景的各种生命周期特征、应用和处理过程都适用于用例。

#### 7.3.3 用例图
用例模型：用例、参与者、关联、系统边界  

## 8 需求获取方法之面谈
### 8.1 概述
面对面的会见（face-to-face meeting）被认为是最具丰富内容的交流方法。也是实践当中应用最为广泛的需求获取方法之一。  
前景和范围指导——准备面谈——主持面谈——整理面谈报告——面谈报告  

### 8.2 准备面谈
#### 8.2.1 准备工作
* 阅读背景资料
* 确定面谈主题和目标
* 选择被会见者
* 通知被会见者做准备
* 确定问题和类型

#### 8.2.2 问题类型 
* 开放式问题：被会见者对答复的选择可以是开放和不受限制的
在希望得到丰富（具有一定深度和广度）信息时，开放式问题比较合适。
* 封闭式问题：答案有基本的形式，被会见者的回答是受到限制的 
* 程序性提示：总结和反馈、重复和改述、建立场景和细节描述、抗辩
* 探究式问题：深究答复以澄清被会见者的要点
* 诱导式问题：引导被会见者按照会见者所想的来回答
* 元问题：关于面谈本身的问题

#### 8.2.3 问题准备
前期以开放式问题为主，面谈对象以决策层与专家为主，遵循 问题-目标-解决方案 的路线，分析基本的涉众特点。  
后期以封闭式问题为主，抓住主题与线索，重视问题针对性，事先准备面谈记录材料。

### 8.3 主持面谈
#### 8.3.1 面谈开始阶段
开场仪式：握手  
简要重申面谈的目标  
准备好笔记本、录音机或者其他记录设备   
用一些非常一般的、轻松的、开放式的问题 作为开始  

#### 8.3.2 面谈主体阶段
保持有礼貌的倾听  
控制面谈过程   
保持面谈主题   
使用探究式问题  
观察被会见者  
使用道具支持  

#### 8.3.3 面谈结束阶段
面谈应该在45分钟到1小时内结束，结束面谈应该比开始面谈更自然；  
总结谈话的要点，确保记录下了面谈的所有重要信息；  
感谢被会见者，并且给时间让他们询问一些他们自己关心的问题；  
握手话别。   

### 8.4 整理面谈报告
* 复查面谈记录：整理出内容要点，进行分类 
* 总结面谈信息：评估面谈中所得到的信息 
* 完成面谈报告

### 8.5 面谈的类别
* 结构化面谈
* 半结构化面谈
* 非结构化面谈

### 8.6 面谈的优缺点
开展简单、获取内容广泛、建立友好关系、提高参与热情。  
时间成本较高、地理分散情况难以面谈、依赖人际交流能力、产生错误数据、不了解被会见者认知结构，  

### 8.7 群体面谈
群体面谈、调查问卷、头脑风暴

## 9 需求获取之原型
### 9.1 原型及原型法概述
#### 9.1.1 不确定性
不确定性是广泛存在的，原型、迭代和（方法）验证是人们解决不确定性的主要手段。

#### 9.1.2 原型及原型法
原型是一个系统，它内化了（capture）一个更迟系统（later system）的本质特征。原型系统通常被构造为不完整的系统，以在将来进行改进、补充或者替代

#### 9.1.3 原型的用途
* 演示原型
* 严格意义上的原型
* 试验原型
* 引示系统原型

### 9.2 使用原型法进行需求获取
#### 9.2.1 基本过程
确定原型需求、原型开发、原型评估、原型修正

#### 9.2.2 确定原型需求
* 界定不确定性
* 可能发生的需求变更
* 存在冲突的地方
* 信息不充分的地方

#### 9.2.3 原型开发
* 将探索不确定功能需求的原型构建得易于修改
* 让探索可行性的原型收集充分的数据
* 控制开发成本

#### 9.2.4 原型评估
* 使用脚本指导评估过程
* 创造无偏见的评估环境
* 引导评估者从恰当的角度进行评价
* 观察评估者的行为
* 收集评估者的反馈

#### 9.2.5 原型修正
一方面要依据评估人员的反馈，另一方面也要考虑事先的原型调整计划 

### 9.3 抛弃需求原型
#### 9.3.1 抛弃式原型与演化式原型
探索式、实验式、演化式

#### 9.3.2 坚决抛弃抛弃式原型
因为基于不确定的需求基础，所以抛弃式原型难免反复修改，导致代码质量较低，应该坚决抛弃

### 9.4 控制原型成本
#### 9.4.1 依据抛弃式特征控制原型成本
水平原型方法与垂直原型方法 
用尽可能低的成本开发水平原型

#### 9.4.2 使用尽量简单的介质降低原型成本
纸质介质、幻灯片介质、快速语言工具、程序语言

### 9.5 故事板原型
将原来分散的功能与步骤组织成故事，让普通人能够更好地体验与评估  
明确故事板原型要素角色（Who）；内容（What）；方法（How）。  
建不同类型的故事板原型被动（Passive）故事板原型主动（Active）故事板原型交互（Interactive）故事板原型  

### 9.6 原型方法的风险
* 成本失控
* 给客户造成错误印象
* 被非功能性特征蒙蔽了眼睛
* 掩盖一些用户假设

## 11 需求分析概述

## 14 面向对象建模
### 14.3 对象模型
#### 14.3.1 对象
对象是指一个应用中具有明确角色的独立可确认的实体。每个对象包含标识、状态、行为。理想的单一职责对象应该仅仅扮演一个角色。

#### 14.3.2 对象之间的关系
链接：对象之间的物理、业务联系。假设与期望，导航与可见性

#### 14.3.3 类
共享相同属性和行为的对象的集合，为属于该类的所有对象提供统一的抽象描述（接口）和生成模板（实现）。类的分类包括数据驱动（属性的相同性）和职责驱动（事物的相似性）

#### 14.3.4 类之间的关系
类之间的关系，描述的特性包括：角色、可见性、方向、限定关联。
组合、聚合、继承、多态（重载、泛型）

### 14.4 建立领域模型
#### 14.4.1 识别候选对象与类
* 概念类分类列表
* 名词分析
* 行为分析

#### 14.4.2 确定概念类
* 既有状态又有行为：独立存在的对象
* 只有状态没有行为：分析存在是否是系统需要的数据
* 只有行为没有状态：意味着需求信息的遗漏

#### 14.4.3 建立类之间的关联
* 保证类协作之间的可见性
* 使用问题域内的关联
* 不要在识别上花费过多时间
* 避免显示冗余和导出的关联

#### 14.4.4 添加类的重要属性
记录类协作时所必要的信息

### 14.5 行为模型——交互图
#### 14.5.1 概述
描述单个用例的场景，为了某个目标而执行的一系列消息交换。

#### 14.5.2 顺序图
对象、生命线、激活态、消息（异步、同步、返回）、创建、撤销
组合片段：option、alternative、loop、break、reference、parallel

#### 14.5.3 通信图
突出交互当中协作对象之间的关系

#### 14.5.4 系统顺序图
强调外部参与者和系统的交互行为

### 14.6 建立交互图
#### 14.6.1 建立典型场景的系统顺序图
1. 确定系统顺序图的上下文环境
2. 找出参与交互的对象。
3. 根据发现的对象建立交互图框架。将对象平行排列，并添加对象的生命线。
4. 添加消息，描述交互行为

#### 14.6.2 建立用例（多场景）系统顺序图
先为主流程场景建立基础的系统顺序图，然后根据分支场景与异常场景的分支点、异常点，建立组合片段描述

#### 14.6.3 建立详细顺序图
为了正确识别参与交互的对象，不能添加设计因素。

### 14.7 行为模型——状态图
#### 14.7.1 状态图的发展历程
以状态机理论为基础建立的对系统行为的描述手段，主要用于描述重要而且复杂的对象的所有行为。

#### 14.7.2 有限状态机
某一时刻系统只能处于一种状态：状态、触发事件、状态转移函数、初始状态、结束状态集合。

#### 14.7.3 David Harel的发展
* 设定触发条件
* 引入起始状态与结束状态
* 组合状态：建立状态子图
* 历史机制：上一次离开状态时的子状态
* 并发状态

### 14.8 建立状态图
#### 14.8.1 基于状态转移矩阵建立状态图
* 确定上下文环境
* 识别状态
* 建立状态转换
* 补充详细信息

### 14.9 对象约束语言
#### 14.9.1 概述
避免自然语言描述的模糊性，也不像动作规约语言那样繁琐。

#### 14.9.2 对象约束语言的构成
逻辑运算、条件判断、包环境声明、不变量、前置条件、后置条件

### 14.11 基于CRC卡面向对象分析方法
#### 14.11.1 CRC卡
背面是关于候选对象的非正式描述，正面记录了职责和协作者

#### 14.11.2 基于CRC卡的职责驱动方法
* 确定主题
* 识别候选对象
* 描述对象特性
* 发现系统职责
* 分配系统职责
* 建立对象之间的协作

---
### 复习 关键词提纲
#### 2 需求基础
* 基本概念：需求、问题、问题域-[共享现象]-解系统、需求规格说明
* **需求的层次性**：
  * 战略问题 - 业务需求BR（为什么要开发系统） - 解决方案与系统特性SF（限定了系统的范围）
  * 任务问题 - 用户需求UR（用户对系统的期望）- 问题域知识
  * 系统行为问题 - 系统级需求SR（关注软件系统的行为）- 需求分析模型
* **需求的分类**：
  * 功能需求：活动 行为交互
  * 性能需求PR：性能特征
  * 质量属性QR：可靠性、可用性、可维护性、安全性、易用性
  * 对外接口IR：硬件接口、软件接口、数据库接口
  * 约束：编程语言、硬件设施、相关标准、商业规则
* 需求的特性（正确写法）：完备性、正确性、可行性、必要性、无歧义、可验证

#### 5 确定项目的前景和范围
* **问题分析过程**：
  * 获取问题：收集资料、与涉众沟通
  * 明确问题P：对问题达成共识、判断问题明确性、分析不明确问题
  * 发现业务需求BR（具有可验证性）
  * 定义问题解决方案和系统特性SF
    * 确定高层次的问题解决方案
    * 确定系统特性与解决方案的边界：系统特性、用例图、问题的上下文图
    * 确定解决方案的约束
* 目标：
  * 目标是系统被开发的目的，注意区分目标的主体和拥有者
  * 不同的类型：功能目标与非功能目标；高层次目标和低层次目标；软目标和硬目标
  * 基本模式：实现、终止、保持、避免、优化
  * 关系：精化关系（AND、OR）、阻碍关系、支持与冲突关系（Support、Conflict）、其他元素
* **目标分析**：
  * 获取高层目标：现状和背景的分析、问题和缺陷
  * 目标精化：建立系统的目标模型
    * AND：不同场景；连续过程；多个方面；不同质量环境
    * OR：互相替代的候选方法
    * 考虑阻碍目标实现的情况；考虑已有目标之间的支持和冲突关系
  * 目标实现：收集目标相关的需求信息、讨论可能的候选方案、确定详细的系统需求和解决方案
* **业务过程分析**：
  * 确定上下文环境
  * 分析业务流程中的主要处理步骤
  * 分析业务流程中的主要数据流
  * 识别参与者
  * 进行职责分配
  * 添加详细信息
* 图表：
  * 问题描述表
  * 鱼骨图：每个分支代表一个可能的原因
  * 候选解决方案表：ID、方案描述、业务优势、代价
  * 用例图：外部角色在与解决方案的交互中完成的任务与目标
  * 问题的上下文图：关注解决方案与环境之间的信息流输入/输出

#### 6 涉众分析与硬数据采样
* **涉众分析过程**：
  * 涉众识别：发现所有涉众类别、过滤非关键涉众类别、维护涉众类别
  * 涉众描述：个人特征、工作特征、地理和社会特征
  * 涉众评估：优先级评估、风险评估、共赢分析
  * 涉众代表选择：完整采样、态度积极、数量适中、比例恰当
  * 参与策略制定：合适的时间参与合适的工作
* 图表：
  * 涉众特征描述：主要目标、态度、主要关注点、约束条件
  * Power/Interest分布图、Power/Attitude分布图

#### 7 基于用例场景模型展开用户需求获取
* 基本概念：场景（形式、内容、目的、生命周期）、用例、用例图（用例、参与者、关系、系统边界）
* 用户需求获取活动的展开：
  * 保持项目范围不能遗漏需求
  * 多轮次获取：前景与范围阶段/用户需求获取阶段
  * 根据内容合理安排获取方法：面谈/头脑风暴/原型/观察
  * 及时组织已获取需求：模型驱动方法；承上启下
* 用例/场景的层次性：对应需求的三层次
* 用例/场景模型过程：
  * 依据系统用例图、目标模型建立初始用例/场景模型
  * 根据用例/场景模型指导需求获取，完善层次结构
  * 使用用例/场景组织获取内容
  * 分析用例/场景发现仍需获取的需求内容
  * 验证场景/用例模型
* 图表：
  * 用例/场景描述：ID、名称、用例属性、参与者、描述、优先级、触发条件、前置条件、后置条件、正常流程、扩展流程（分支流程和异常流程）
  * 用例图：用例、参与者、关系、系统边界

#### 8 需求获取方法之面谈
* 准备面谈：
  * 准备工作：阅读背景材料、确定面谈主题和目标、选择被会见者、通知被会见者、确定问题和类型
  * **问题类型**：开放式问题/封闭式问题/程序性提示/诱导式问题/探究式问题
  * 问题准备：前期/后期
* 主持面谈：
  * 开始：建立一个理想的氛围和环境
  * 主体：保持礼貌的倾听；控制面谈过程；保持面谈主题；探究式问题；观察；道具支持
  * 结束：表示感谢，握手话别
  * 记录：笔录/录音和摄像
* 其他：
  * 整理面谈报告：会见者，被会见者，会见目标，谈话要点，被会见者观点，下次会见的目标
  * 面谈的类别：结构化面谈，半结构化面谈，非结构化面谈
  * 优点与局限性
* 群体面谈和头脑风暴

#### 9 原型法
* 原型和原型法：为了解决软件工程中的不确定性
  * 演示原型-技术
  * 严格意义上的原型-用户界面
  * 试验原型-系统构建
  * 引示系统原型-增长核心
* 原型法获取需求：确定原型需求、原型开发、原型评估、原型修正
* 原型法的使用要点：
  * 坚决抛弃抛弃式原型（探索式、实验式、演化式）
  * 控制原型成本（水平原型方法、垂直原型方法）
  * 善用故事板原型（场景模型）：角色、内容、方法
  * 控制原型法风险

#### 10 观察和文档审查
* 观察：采样观察、民族志
* 文档审查方法：需求重用、文档分析、需求剥离

#### 11 需求分析概述

* 模型：抽象、分解、投影

* 需求细化：细化用户需求、补充隐含因素、细化非功能需求、发现新的需求、足够具体时停止。
* 确定优先级：累计投票、区域划分、Top-N、数据量化

#### 14 面向对象分析
* 对象模型——概念类图：识别候选对象和类、确定概念类、建立类之间的关联、添加类的重要属性
* 行为模型——交互图：基于用例的系统顺序图、详细顺序图
* 行为模型——状态图
* 交互契约OCL
* CRC建模

#### 15 需求规格说明

* 文档写作技巧：
  * 内容的组织：所有内容位置得当；引用或强化，但不重复
  * 表达方式：形式依赖于内容；系统的表达方式
  * 细节描述：定义术语表或数据字典；避免干扰文本；避免歧义词汇

* 基本特征：完备性、一致性、根据重要性和稳定性分级、可修改、可跟踪

#### 16 需求验证

* 基本概念：
  * 需求验证：以正确的方式建立需求
  * 需求确认：建立的需求是正确的
* 需求验证方法：评审、原型与模拟、开发测试用例、用户手册编制、利用跟踪关系、自动化分析
* 问题修正：需求澄清、确实需求、需求冲突、不切实际的期望

#### 17 需求管理

* 需求管理：意图、作用、任务、活动
* 维护需求基线
  * 需求基线：已通过正式评审和批准的规格说明或产品
  * 配置管理，状态维护
* 实现需求跟踪：以需求规格说明文档为基线，在向前向后两个方向上描述需求以及跟踪需求变化的能力。
  * 实现方法：矩阵、实体关系模型、交叉引用
* 控制变更
  * 需求变化：问题发生改变；环境发生改变；需求基线存在缺陷
  * 注意：认识到变更的重要性并制定计划；维护需求基线，审计变更记录；管理项目蔓延；灵活应对变更请求；使用辅助工具 

### 复习 课本案例
* 需求的层次性：超市管理系统的需求层次
* 问题分析过程：连锁商店销售系统的问题分析
* 目标分析过程：连锁商店销售系统的目标模型
* 涉众描述：化学制品跟踪系统的涉众描述、自助餐厅在线订餐系统的涉众扩展特征描述
* 用例/场景的层次性：销售处理用户示例